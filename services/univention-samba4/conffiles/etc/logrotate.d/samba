@%@UCRWARNING=# @%@

@!@
import univention.lib.ucrLogrotate

for name in ('smbd', 'nmbd'):
    settings = univention.lib.ucrLogrotate.getLogrotateConfig(name, configRegistry)
    print("/var/log/samba/log.%s {" % name)
    for setting in sorted(settings):
        print("\t%s" % settings[setting])
    print("\tpostrotate")
    print("\t\t/usr/bin/killall -HUP /usr/sbin/%s" % name)
    print("\tendscript")
    print("}")

filelist = [ "/var/log/samba/%s" % name for name in ('log.samba-dcerpcd', 'log.rpcd_*')]
print(" ".join(filelist) + " {")
for setting in sorted(settings):
    print("\t%s" % settings[setting])
print("\tsharedscripts")
print("\tpostrotate")
print("\t\t{ pidof samba-dcerpcd && pkill --signal HUP samba-dcerpcd; } > /dev/null")
print("\tendscript")
print("}")
@!@
